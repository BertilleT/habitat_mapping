----------------------- UNet -----------------------
Patch size: 256
Classification level: 1
Using device: cuda
Loading data...
Data loading settings:
Splitting data: [0.6, 0.2, 0.2]
Stratified: random
Batch size: 16
Train: 6397 images, Val: 2133 images, Test: 2133 images
Train: 59.99%, Val: 20.00%, Test: 20.00%
/home/bertille/miniconda3/envs/ecomed_venv/lib/python3.12/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at ../aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
/home/bertille/miniconda3/envs/ecomed_venv/lib/python3.12/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at ../aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
Creating model...
Model settings:
Encoder name: efficientnet-b7
Pretrained: None
Classes: 6
Creating optimizer...
Training settings:
Learning rate: 0.0001
Criterion: Dice
Optimizer: Adam
Training...
Epoch 1/200
Training
Batch: 0  over  400


















































Batch: 50  over  400


















































Batch: 100  over  400


















































Batch: 150  over  400


















































Batch: 200  over  400


















































Batch: 250  over  400


















































Batch: 300  over  400


















































Batch: 350  over  400


















































Validation
Batch: 0  over  134
Batch: 50  over  134
Batch: 100  over  134
Epoch 1/200: train loss 0.6737, val loss 0.8070
Epoch 1/200: train mIoU 0.2297, val mIoU 0.0968
Epoch 2/200
Training
Batch: 0  over  400


















































Batch: 50  over  400


















































Batch: 100  over  400


















































Batch: 150  over  400


















































Batch: 200  over  400


















































Batch: 250  over  400


















































Batch: 300  over  400


















































Batch: 350  over  400


















































Validation
Batch: 0  over  134
Batch: 50  over  134
Batch: 100  over  134
Epoch 2/200: train loss 0.5695, val loss 0.5288
Epoch 2/200: train mIoU 0.3079, val mIoU 0.3546
Epoch 3/200
Training
Batch: 0  over  400


















































Batch: 50  over  400


















































Batch: 100  over  400


















































Batch: 150  over  400


















































Batch: 200  over  400


















































Batch: 250  over  400


















































Batch: 300  over  400


















































Batch: 350  over  400


















































Validation
Batch: 0  over  134
Batch: 50  over  134
Batch: 100  over  134
Epoch 3/200: train loss 0.5265, val loss 0.4820
Epoch 3/200: train mIoU 0.3370, val mIoU 0.3934
Epoch 4/200
Training
Batch: 0  over  400


















































Batch: 50  over  400


















































Batch: 100  over  400


















































Batch: 150  over  400


















































Batch: 200  over  400


















































Batch: 250  over  400


















































Batch: 300  over  400


















































Batch: 350  over  400


















































Validation
Batch: 0  over  134
Batch: 50  over  134
Batch: 100  over  134
Epoch 4/200: train loss 0.5030, val loss 0.4681
Epoch 4/200: train mIoU 0.3513, val mIoU 0.4034
Epoch 5/200
Training
Batch: 0  over  400


















































Batch: 50  over  400


















































Batch: 100  over  400


















































Batch: 150  over  400


















































Batch: 200  over  400


















































Batch: 250  over  400


















































Batch: 300  over  400


















































Batch: 350  over  400


















































Validation
Batch: 0  over  134
Batch: 50  over  134
Batch: 100  over  134
Epoch 5/200: train loss 0.4866, val loss 0.5098
Epoch 5/200: train mIoU 0.3668, val mIoU 0.3609
Epoch 6/200
Training
Batch: 0  over  400


















































Batch: 50  over  400


















































Batch: 100  over  400


















































Batch: 150  over  400


















































Batch: 200  over  400


















































Batch: 250  over  400


















































Batch: 300  over  400


















































Batch: 350  over  400


















































Validation
Batch: 0  over  134
Batch: 50  over  134
Batch: 100  over  134
Epoch 6/200: train loss 0.4843, val loss 0.4683
Epoch 6/200: train mIoU 0.3702, val mIoU 0.3992
Epoch 7/200
Training
Batch: 0  over  400


















































Batch: 50  over  400


















































Batch: 100  over  400


















































Batch: 150  over  400


















































Batch: 200  over  400


















































Batch: 250  over  400


















































Batch: 300  over  400


















































Batch: 350  over  400


















































Validation
Batch: 0  over  134
Batch: 50  over  134
Batch: 100  over  134
Epoch 7/200: train loss 0.4674, val loss 0.4406
Epoch 7/200: train mIoU 0.3841, val mIoU 0.4353
Epoch 8/200
Training
Batch: 0  over  400


















































Batch: 50  over  400


















































Batch: 100  over  400


















































Batch: 150  over  400


















































Batch: 200  over  400


















































Batch: 250  over  400


















































Batch: 300  over  400


















































Batch: 350  over  400


















































Validation
Batch: 0  over  134
Batch: 50  over  134
Batch: 100  over  134
Epoch 8/200: train loss 0.4592, val loss 0.4615
Epoch 8/200: train mIoU 0.3915, val mIoU 0.4115
Epoch 9/200
Training
Batch: 0  over  400


















































Batch: 50  over  400


















































Batch: 100  over  400


















































Batch: 150  over  400


















































Batch: 200  over  400


















































Batch: 250  over  400


















































Batch: 300  over  400


















































Batch: 350  over  400


















































Validation
Batch: 0  over  134
Batch: 50  over  134
Batch: 100  over  134
Epoch 9/200: train loss 0.4487, val loss 0.4659
Epoch 9/200: train mIoU 0.4028, val mIoU 0.4078
Epoch 10/200
Training
Batch: 0  over  400


















































Batch: 50  over  400


















































Batch: 100  over  400


















































Batch: 150  over  400


















































Batch: 200  over  400


















































Batch: 250  over  400


















































Batch: 300  over  400


















































Batch: 350  over  400


















































Validation
Batch: 0  over  134
Batch: 50  over  134
Batch: 100  over  134
Epoch 10/200: train loss 0.4377, val loss 0.4428
Epoch 10/200: train mIoU 0.4121, val mIoU 0.4260
Epoch 11/200
Training
Batch: 0  over  400


















































Batch: 50  over  400


















































Batch: 100  over  400


















































Batch: 150  over  400


















































Batch: 200  over  400


















































Batch: 250  over  400


















































Batch: 300  over  400


















































Batch: 350  over  400


















































Validation
Batch: 0  over  134
Batch: 50  over  134
Batch: 100  over  134
Epoch 11/200: train loss 0.4504, val loss 0.4285
Epoch 11/200: train mIoU 0.4053, val mIoU 0.4495
Epoch 12/200
Training
Batch: 0  over  400


















































Batch: 50  over  400


















































Batch: 100  over  400


















































Batch: 150  over  400


















































Batch: 200  over  400


















































Batch: 250  over  400


















































Batch: 300  over  400


















































Batch: 350  over  400


















































Validation
Batch: 0  over  134
Batch: 50  over  134
Batch: 100  over  134
Epoch 12/200: train loss 0.4329, val loss 0.4340
Epoch 12/200: train mIoU 0.4208, val mIoU 0.4408
Epoch 13/200
Training
Batch: 0  over  400


















































Batch: 50  over  400


















































Batch: 100  over  400


















































Batch: 150  over  400


















































Batch: 200  over  400


















































Batch: 250  over  400


















































Batch: 300  over  400


















































Batch: 350  over  400


















































Validation
Batch: 0  over  134
Batch: 50  over  134
Batch: 100  over  134
Epoch 13/200: train loss 0.4255, val loss 0.4304
Epoch 13/200: train mIoU 0.4316, val mIoU 0.4416
Epoch 14/200
Training
Batch: 0  over  400


















































Batch: 50  over  400


















































Batch: 100  over  400


















































Batch: 150  over  400


















































Batch: 200  over  400


















































Batch: 250  over  400


















































Batch: 300  over  400


















































Batch: 350  over  400


















































Validation
Batch: 0  over  134
Batch: 50  over  134
Batch: 100  over  134
Epoch 14/200: train loss 0.4219, val loss 0.3963
Epoch 14/200: train mIoU 0.4341, val mIoU 0.4836
Epoch 15/200
Training
Batch: 0  over  400


















































Batch: 50  over  400


















































Batch: 100  over  400


















































Batch: 150  over  400


















































Batch: 200  over  400


















































Batch: 250  over  400


















































Batch: 300  over  400


















































Batch: 350  over  400


















































Validation
Batch: 0  over  134
Batch: 50  over  134
Batch: 100  over  134
Epoch 15/200: train loss 0.4140, val loss 0.4210
Epoch 15/200: train mIoU 0.4362, val mIoU 0.4564
Epoch 16/200
Training
Batch: 0  over  400


















































Batch: 50  over  400


















































Batch: 100  over  400


















































Batch: 150  over  400


















































Batch: 200  over  400


















































Batch: 250  over  400


















































Batch: 300  over  400


















































Batch: 350  over  400


















































Validation
Batch: 0  over  134
Batch: 50  over  134
Batch: 100  over  134
Epoch 16/200: train loss 0.4173, val loss 0.4329
Epoch 16/200: train mIoU 0.4343, val mIoU 0.4433
Epoch 17/200
Training
Batch: 0  over  400


















































Batch: 50  over  400


















































Batch: 100  over  400


















































Batch: 150  over  400


















































Batch: 200  over  400


















































Batch: 250  over  400


















































Batch: 300  over  400


















































Batch: 350  over  400


















































Validation
Batch: 0  over  134
Batch: 50  over  134
Batch: 100  over  134
Epoch 17/200: train loss 0.4143, val loss 0.4434
Epoch 17/200: train mIoU 0.4402, val mIoU 0.4328
Epoch 18/200
Training
Batch: 0  over  400


















































Batch: 50  over  400


















































Batch: 100  over  400


















































Batch: 150  over  400


















































Batch: 200  over  400


















































Batch: 250  over  400


















































Batch: 300  over  400


















































Batch: 350  over  400


















































Validation
Batch: 0  over  134
Batch: 50  over  134
Batch: 100  over  134
Epoch 18/200: train loss 0.4133, val loss 0.4137
Epoch 18/200: train mIoU 0.4420, val mIoU 0.4640
Epoch 19/200
Training
Batch: 0  over  400


















































Batch: 50  over  400


















































Batch: 100  over  400


















































Batch: 150  over  400


















































Batch: 200  over  400


















































Batch: 250  over  400


















































Batch: 300  over  400


















































Batch: 350  over  400


















































Validation
Batch: 0  over  134
Batch: 50  over  134
Batch: 100  over  134
Epoch 19/200: train loss 0.4021, val loss 0.3921
Epoch 19/200: train mIoU 0.4547, val mIoU 0.4869
Epoch 20/200
Training
Batch: 0  over  400


















































Batch: 50  over  400


















































Batch: 100  over  400


















































Batch: 150  over  400


















































Batch: 200  over  400


















































Batch: 250  over  400


















































Batch: 300  over  400


















































Batch: 350  over  400


















































Validation
Batch: 0  over  134
Batch: 50  over  134
Batch: 100  over  134
Epoch 20/200: train loss 0.3978, val loss 0.4089
Epoch 20/200: train mIoU 0.4604, val mIoU 0.4783
Epoch 21/200
Training
Batch: 0  over  400


















































Batch: 50  over  400


















































Batch: 100  over  400


















































Batch: 150  over  400


















































Batch: 200  over  400


















































Batch: 250  over  400


















































Batch: 300  over  400


















































Batch: 350  over  400


















































Validation
Batch: 0  over  134
Batch: 50  over  134
Batch: 100  over  134
Epoch 21/200: train loss 0.3994, val loss 0.4227
Epoch 21/200: train mIoU 0.4599, val mIoU 0.4549
Epoch 22/200
Training
Batch: 0  over  400


















































Batch: 50  over  400


















































Batch: 100  over  400


















































Batch: 150  over  400


















































Batch: 200  over  400


















































Batch: 250  over  400


















































Batch: 300  over  400


















































Batch: 350  over  400


















































Validation
Batch: 0  over  134
Batch: 50  over  134
Batch: 100  over  134
Epoch 22/200: train loss 0.3954, val loss 0.4104
Epoch 22/200: train mIoU 0.4635, val mIoU 0.4691
Epoch 23/200
Training
Batch: 0  over  400


















































Batch: 50  over  400


















































Batch: 100  over  400


















































Batch: 150  over  400


















































Batch: 200  over  400


















































Batch: 250  over  400


















































Batch: 300  over  400


















































Batch: 350  over  400


















































Validation
Batch: 0  over  134
Batch: 50  over  134
Batch: 100  over  134
Epoch 23/200: train loss 0.3875, val loss 0.4019
Epoch 23/200: train mIoU 0.4705, val mIoU 0.4757
----------------------- UNet -----------------------
Patch size: 256
Classification level: 1
Using device: cuda
Loading data...
Data loading settings:
Splitting data: [0.6, 0.2, 0.2]
Stratified: random
Batch size: 16
Train: 6397 images, Val: 2133 images, Test: 2133 images
Train: 59.99%, Val: 20.00%, Test: 20.00%
/home/bertille/miniconda3/envs/ecomed_venv/lib/python3.12/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at ../aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
/home/bertille/miniconda3/envs/ecomed_venv/lib/python3.12/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at ../aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
Creating model...
Model settings:
Encoder name: efficientnet-b7
Pretrained: None
Classes: 6
Model from epoch 19  loaded
Creating optimizer...
Training settings:
Learning rate: 0.0001
Criterion: Dice
Optimizer: Adam
Training...
training_losses:  [0.6737031016498805, 0.569519335180521, 0.5265097877383232, 0.5029983933269978, 0.4866325303539633, 0.4842653898149728, 0.4674302719533443, 0.4592308620363474, 0.448689125329256, 0.4376581326499581, 0.4503968790918589, 0.4329114566370844, 0.4254622881673276, 0.4218597975187003, 0.414048324059695, 0.417310572117567, 0.4142679284140467, 0.4133049026317894, 0.4020837137475609, 0.3977961008623242, 0.3993862411379814, 0.3954382459074259, 0.3875100511685014]
validation_losses:  [0.8069892572378045, 0.528760801833957, 0.4819790340626417, 0.4681061942185928, 0.5098263946042132, 0.4682755081622458, 0.4405946317893355, 0.4615134242088047, 0.4658904016129117, 0.4427590164453236, 0.428459523440297, 0.4340265181694013, 0.430415188365463, 0.3963366378821544, 0.4210242423326222, 0.4328653278635509, 0.4433891137700472, 0.413723487406969, 0.3920943923572551, 0.4088868013958432, 0.4227085076828501, 0.41043161965017, 0.4018830737905271]
training_miou:  [0.2296711342305324, 0.3078773530762984, 0.3369763213820655, 0.3512833296599045, 0.3667645501835587, 0.3701675303272938, 0.3840924626519816, 0.3914831965782592, 0.4027597176241966, 0.412088393697757, 0.4052544904412276, 0.4207706522489933, 0.4315870473439046, 0.4341202607098983, 0.4361859781238291, 0.4343027644288308, 0.4401898082852595, 0.4420386752899481, 0.4546936178961609, 0.4604314358630312, 0.4599312115070573, 0.4635000889509586, 0.4704711167036703]
validation_miou:  [0.0968114268249566, 0.3546498741786068, 0.3933541906101086, 0.4034418209069407, 0.360901204472762, 0.3991898148321862, 0.4353260167388057, 0.4115412867236691, 0.4078267604712738, 0.4259970701856861, 0.4495192921215165, 0.4407948915159454, 0.4416471927627159, 0.4836114515610306, 0.4564212880179472, 0.4432786436614258, 0.4327548029946209, 0.4639975398013541, 0.4869178269539266, 0.4782861459039857, 0.4549145683288029, 0.4691286770621032, 0.4756578601890613]
best_val_loss 0.3920943923572551
Losses and iou loaded
Skipping epoch 1/200
Skipping epoch 2/200
Skipping epoch 3/200
Skipping epoch 4/200
Skipping epoch 5/200
Skipping epoch 6/200
Skipping epoch 7/200
Skipping epoch 8/200
Skipping epoch 9/200
Skipping epoch 10/200
Skipping epoch 11/200
Skipping epoch 12/200
Skipping epoch 13/200
Skipping epoch 14/200
Skipping epoch 15/200
Skipping epoch 16/200
Skipping epoch 17/200
Skipping epoch 18/200
Skipping epoch 19/200
Epoch 20/200
Training
Batch: 0  over  400


















































Batch: 50  over  400


















































Batch: 100  over  400


















































Batch: 150  over  400


















































Batch: 200  over  400


















































Batch: 250  over  400


















































Batch: 300  over  400


















































Batch: 350  over  400


















































Validation
Batch: 0  over  134
Batch: 50  over  134
Batch: 100  over  134
Epoch 20/200: train loss 0.3999, val loss 0.4261
Epoch 20/200: train mIoU 0.4569, val mIoU 0.4510
Epoch 21/200
Training
Batch: 0  over  400


















































Batch: 50  over  400


















































Batch: 100  over  400


















































Batch: 150  over  400


















































Batch: 200  over  400


















































Batch: 250  over  400


















































Batch: 300  over  400


















































Batch: 350  over  400


















































Validation
Batch: 0  over  134
Batch: 50  over  134
Batch: 100  over  134
Epoch 21/200: train loss 0.3966, val loss 0.3948
Epoch 21/200: train mIoU 0.4619, val mIoU 0.4917
Epoch 22/200
Training
Batch: 0  over  400


















































Batch: 50  over  400


















































Batch: 100  over  400


















































Batch: 150  over  400


















































Batch: 200  over  400


















































Batch: 250  over  400


















































Batch: 300  over  400


















































Batch: 350  over  400


















































Validation
Batch: 0  over  134
Batch: 50  over  134
Batch: 100  over  134
Epoch 22/200: train loss 0.3860, val loss 0.4043
Epoch 22/200: train mIoU 0.4751, val mIoU 0.4829
Epoch 23/200
Training
Batch: 0  over  400


















































Batch: 50  over  400


















































Batch: 100  over  400


















































Batch: 150  over  400


















































Batch: 200  over  400


















































Batch: 250  over  400


















































Batch: 300  over  400


















































Batch: 350  over  400


















































Validation
Batch: 0  over  134
Batch: 50  over  134
Batch: 100  over  134
Epoch 23/200: train loss 0.4014, val loss 0.3875
Epoch 23/200: train mIoU 0.4580, val mIoU 0.4967
Epoch 24/200
Training
Batch: 0  over  400


















































Batch: 50  over  400


















































Batch: 100  over  400


















































Batch: 150  over  400


















































Batch: 200  over  400


















































Batch: 250  over  400


















































Batch: 300  over  400


















































Batch: 350  over  400


















































Validation
Batch: 0  over  134
Batch: 50  over  134
Batch: 100  over  134
Epoch 24/200: train loss 0.3896, val loss 0.4091
Epoch 24/200: train mIoU 0.4707, val mIoU 0.4677
Epoch 25/200
Training
Batch: 0  over  400


















































Batch: 50  over  400


















































Batch: 100  over  400


















































Batch: 150  over  400


















































Batch: 200  over  400


















































Batch: 250  over  400


















































Batch: 300  over  400


















































Batch: 350  over  400


















































Validation
Batch: 0  over  134
Batch: 50  over  134
Batch: 100  over  134
Epoch 25/200: train loss 0.3912, val loss 0.4078
Epoch 25/200: train mIoU 0.4725, val mIoU 0.4807
Epoch 26/200
Training
Batch: 0  over  400


















































Batch: 50  over  400


















































Batch: 100  over  400


















































Batch: 150  over  400


















































Batch: 200  over  400


















































Batch: 250  over  400


















































Batch: 300  over  400


















































Batch: 350  over  400


















































Validation
Batch: 0  over  134
Batch: 50  over  134
Batch: 100  over  134
Epoch 26/200: train loss 0.3820, val loss 0.3638
Epoch 26/200: train mIoU 0.4788, val mIoU 0.5265
Epoch 27/200
Training
Batch: 0  over  400


















































Batch: 50  over  400


















































Batch: 100  over  400


















































Batch: 150  over  400


















































Batch: 200  over  400


















































Batch: 250  over  400


















































Batch: 300  over  400


















































Batch: 350  over  400


















































Validation
Batch: 0  over  134
Batch: 50  over  134
Batch: 100  over  134
Epoch 27/200: train loss 0.3750, val loss 0.4063
Epoch 27/200: train mIoU 0.4945, val mIoU 0.4790
